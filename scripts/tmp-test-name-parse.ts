import dotenv from 'dotenv';
import path from 'path';
dotenv.config({ path: path.resolve(__dirname, '../.env.production.local') });

import { parseAL3File } from '../src/lib/al3/parser';

// Test with actual raw content from database
const testCases = [
  // GEICO - standard format
  `2TRG212 7 98HAWKSOFT 3P CAUTO FMGBN  IBM202GEICGEICO Marine Insurance CoIBMYX67JQA                                   9300129277               01632602040163    2603210RWL                          20260204202603212TCG135 3 9207O922255014D5206K                                                                                                         5BIS172 2 B10001              P        TRAVIS                     ROBINSON                ????????????????????????????????????????????????????????????IN????????????????????9BIS343 9 B10001              586 Lake Rd                   ??????????????????????????????Steele             AL35987    2564586761    ??????????????????????????????????????????B?????????????????????????????????????????????????????????????????????????????????????????????????????3MTG240 1 0000163000`,

  // Progressive - standard format
  `2TRG212 7 98         3P PAUTO FMGBN  IBM216PROGPROGRESSIVE              0272D                                                                 00282602010028    2602030RWL                          202602012026020356313957
2TCG135 3 9207O92225302693206I
5BIS172 2 B10001              P        Robert                     Lange                   ??????????????????????????????????????????????????????????????????????????????????
9BIS343 9 B10001              2880 County Rd 1670           ??????????????????????????????Cullman            AL35058    2565021923    ?????????????????????????????????
3MTG240 1 0000028000`,
];

console.log('=== NAME PARSING TEST ===\n');

for (let i = 0; i < testCases.length; i++) {
  console.log(`\n--- Test Case ${i + 1} ---`);
  const transactions = parseAL3File(testCases[i]);

  for (const tx of transactions) {
    console.log('Policy:', tx.header.policyNumber);
    console.log('Carrier:', tx.header.carrierName);
    console.log('Insured Name:', tx.header.insuredName);
    console.log('LOB:', tx.header.lineOfBusiness);
  }
}

process.exit(0);
